<!DOCTYPE HTML>
<!--[if IE 6]>
<html id="ie6" lang="en-US" class="ie ie6 lt-ie9">
<![endif]-->
<!--[if IE 7]>
<html id="ie7" lang="en-US" class="ie ie7 lt-ie9">
<![endif]-->
<!--[if IE 8]>
<html id="ie8" lang="en-US" class="ie ie8 lt-ie9">
<![endif]-->
<!--[if gte IE 9]>
<html lang="en-US" class="ie ie9">
<![endif]-->
<!--[if !(IE)]><!-->
<html lang="en-US" class="">
<!--<![endif]-->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1.0 minimal-ui">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="author" content="marcolago">
    <meta property="og:title" content="Christian Frisson's Presentations">
    <meta property="og:type" content="website">
    <meta property="og:url" content="http://flowtime-js.marcolago.com">
    <meta property="og:image" content="http://marcolago.github.io/flowtime.js/assets/img/share-image.jpg">
    <meta property="og:site_name" content="Christian Frisson's Presentations">
    <meta property="fb:admins" content="1293500397">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:url" content="http://flowtime-js.marcolago.com">
    <meta name="twitter:title" content="Christian Frisson's Presentations">
    <meta name="twitter:description" content="Flowtime.js is an open source framework for easily build HTML presentations or websites. It’s built with web standards in mind and on top of a solid full page grid layout powered by CSS3 hardware accelerated transition and comes with a complete set of Javascript API for deep customization.">
    <meta name="twitter:image" content="http://marcolago.github.io/flowtime.js/assets/img/share-image.jpg">
    <meta name="twitter:creator" content="@marcolago">
    <meta name="description" content="Flowtime.js is an open source framework for easily build HTML presentations or websites. It’s built with web standards in mind and on top of a solid full page grid layout powered by CSS3 hardware accelerated transition and comes with a complete set of Javascript API for deep customization.">
    <title>Christian Frisson's Presentations</title>
    <link rel="stylesheet" href="assets/css/reset.css">
    <link rel="stylesheet" href="css/flowtime.css">
    <link rel="stylesheet" href="css/themes/light.css">
    <link rel="stylesheet" href="assets/css/prism.css">
    <!-- pdf.js -->
    <style>
        #pdfbody {
            background-color: #808080;
            margin: 0;
            padding: 0;
        }
        
        .viewerContainer {
            overflow: auto;
            position: relative;
            width: 90%;
            height: 500px;
        }
    </style>
    <link rel="stylesheet" href="css/pdfjs/pdf_viewer.css">
    <script src="js/pdfjs/compatibility.js"></script>
    <script src="js/pdfjs/pdf.js"></script>
    <script src="js/pdfjs/pdf_viewer.js"></script>
    <link rel="apple-touch-icon-precomposed" href="img/touch-icon-iphone.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="img/touch-icon-ipad.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="img/touch-icon-iphone-retina.png">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="img/touch-icon-ipad-retina.png">
    <link rel="apple-touch-startup-image" href="img/startup-640x920.png" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 2)">
    <link rel="apple-touch-startup-image" href="img/startup-640x1096.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)"> </head>

<body class="">
    <div class="flowtime"> </div>
    <script src="js/brav1toolbox.js"></script>
    <script src="js/flowtime.js"></script>
    <script src="js/d3.v3.min.js"></script>
    <script type="text/javascript" src="js/x3dom.js"></script>
    <script src="js/wavesurfer.js"></script>
    <!-- <script src="js/flowtime.min.js"></script> -->
    <script src="assets/js/prism.js"></script>
    <!--
    <script src="js/tracksplorer-browserified.js"></script>
-->
    <script type="text/javascript">
        var cacheTitle = document.title.replace("Flowtime.js | ", "");
        /*var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-1228618-10']);
        _gaq.push(['_trackPageview']);
        _gaq.push(['_trackEvent', 'Flowtime', 'Landing', document.title]);
        (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();*/
        d3.csv("/MechaMediaDuino.csv", function (error, slides) {
            //console.log('slides',slides)
            var sections = d3.select(".flowtime");
            /*var section = sections.append('div')
            	.attr("class","ft-section")
            	.attr("data-id","section-"+1)
            	//.attr("data-prog",1)*/
            var section;
            var sectionId = 0;
            var pageId = 0;
            slides.forEach(function (slide, i) {
                //console.log('slide',slide);
                if (i === 0 || slides[i].section !== slides[i - 1].section) {
                    sectionId += 1;
                    section = sections.append('div').attr("class", "ft-section").attr("data-id", "section-" + sectionId)
                    pageId += 1;
                    if (i > 0) {
                        section.append('div').attr("id", "/section-" + sectionId + "/page-" + pageId).attr("class", "ft-page").attr("data-id", "page-" + pageId).attr("data-title", slide.section).append("div").attr("class", "stack-center").append("div").attr("class", "stacked-center").append('h1').text(slide.section)
                    }
                }
                pageId += 1;
                var page = section.append('div').attr("id", "/section-" + sectionId + "/page-" + pageId).attr("class", "ft-page").attr("data-id", "page-" + pageId).attr("data-title", slide.section).append("div").attr("class", "stack-center").append("div").attr("class", "stacked-center")
                page.append('h1').text(slide.title);
                
                slide.media.split(';').forEach(function (media,mediaId) {
                
                /// Check if image is supported
                var isImage = false;
                var supportedImageFormats = ['jpg', 'gif', 'png'];
                var imageExtension = media.split('.').pop();
                supportedImageFormats.forEach(function (supportedImageFormat) {
                    if (imageExtension === supportedImageFormat) {
                        isImage = true;
                        //break
                    }
                });
                /// Check if video is supported
                var isVideo = false;
                var supportedVideoFormats = ['mp4'];
                var videoExtension = media.split('.').pop();
                supportedVideoFormats.forEach(function (supportedVideoFormat) {
                    if (videoExtension === supportedVideoFormat) {
                        isVideo = true;
                        //break
                    }
                });
                /// Check if media file is pdf
                var isPdf = false;
                var supportedPdfFormats = ['pdf'];
                var pdfExtension = media.split('.').pop();
                supportedPdfFormats.forEach(function (supportedPdfFormat) {
                    if (pdfExtension === supportedPdfFormat) {
                        isPdf = true;
                        //break
                    }
                });
                /// Check if media file is audio
                var isAudio = false;
                var supportedAudioFormats = ['mp3'];
                var audioExtension = media.split('.').pop();
                supportedAudioFormats.forEach(function (supportedAudioFormat) {
                    if (audioExtension === supportedAudioFormat) {
                        isAudio = true;
                        //break
                    }
                });
                /// Check if media file is x3d
                var isX3d = false;
                var supportedX3dFormats = ['x3d'];
                var x3dExtension = media.split('.').pop();
                supportedX3dFormats.forEach(function (supportedX3dFormat) {
                    if (x3dExtension === supportedX3dFormat) {
                        isX3d = true;
                        //break
                    }
                });
                if (media && media.split(' ').length === 1 && isImage) {
                    //console.log('slide image', media);
                    page.append('img').attr('class','flowtimeImage').attr('id', media).attr('src', 'media/' + media)
                }
                else if (media && media.split(' ').length === 1 && isVideo) {
                    //console.log('slide video', media);
                    page.append('video').attr('class','flowtimeVideo').attr('id', media).attr('src', 'media/' + media).attr('controls', 'true"')
                }
                else if (media && media.split(' ').length === 1 && isX3d) {
                    console.log('slide x3d', media);
                    page.append('x3d').attr('class','flowtimeX3d').attr('width','500px').attr('height','400px').attr('id', media).append('scene').append('inline').attr('url','media/'+media)
                }
                else if (media && media.split(' ').length === 1 && isAudio){
                    var mediaContainer = 'page'+pageId+'media'+mediaId;
                    var waveform = page.append('div').attr('id',mediaContainer);
                    waveform.append('button').attr('class','btn btn-primary')
                    .on('click',function(){wavesurfer.playPause()})
                    .text('play')
                    waveform.append('i').attr('class','glyphicon glyphicon-play')
                    var wavesurfer = WaveSurfer.create({
                        container: '#'+mediaContainer,
                        waveColor: 'gray',
                        progressColor: 'black'
                    });
                    wavesurfer.load('media/'+media);
                }
                else if (media && media.split(' ').length === 1 && isPdf) {
                    //console.log('slide pdf', media);
                    var pdfViewer = page.append('div').attr('id', 'viewerContainer' + pageId).attr('class', 'viewerContainer').append('div').attr('id', 'viewer' + pageId).attr('class', 'pdfViewer')
                        //.attr('src','media/'+media)
                    if (!PDFJS.PDFViewer || !PDFJS.getDocument) {
                        alert('Please build the pdfjs-dist library using\n' + '  `gulp dist`');
                    }
                    // The workerSrc property shall be specified.
                    //
                    PDFJS.workerSrc = 'js/pdfjs/pdf.worker.js';
                    // Some PDFs need external cmaps.
                    //
                    // PDFJS.cMapUrl = '../../build/dist/cmaps/';
                    // PDFJS.cMapPacked = true;
                    var DEFAULT_URL = 'media/' + media;
                    //var SEARCH_FOR = ''; // try 'Mozilla';
                    var container = document.getElementById('viewerContainer' + pageId);
                    // (Optionally) enable hyperlinks within PDF files.
                    var pdfLinkService = new PDFJS.PDFLinkService();
                    var pdfViewer = new PDFJS.PDFViewer({
                        container: container
                        , linkService: pdfLinkService
                    , });
                    pdfLinkService.setViewer(pdfViewer);
                    // (Optionally) enable find controller.
                    var pdfFindController = new PDFJS.PDFFindController({
                        pdfViewer: pdfViewer
                    });
                    pdfViewer.setFindController(pdfFindController);
                    container.addEventListener('pagesinit', function () {
                        // We can use pdfViewer now, e.g. let's change default scale.
                        pdfViewer.currentScaleValue = 'page-width';
                        /*if (SEARCH_FOR) { // We can try search for things
                          pdfFindController.executeCommand('find', {query: SEARCH_FOR});
                        }*/
                    });
                    // Loading document.
                    PDFJS.getDocument(DEFAULT_URL).then(function (pdfDocument) {
                        // Document loaded, specifying document for the viewer and
                        // the (optional) linkService.
                        pdfViewer.setDocument(pdfDocument);
                        //console.log(pdfViewer)
                        pdfLinkService.setDocument(pdfDocument, null);
                    });
                }
                    
                });
                if (slide.reference) {
                    page.append('p').html(slide.reference)
                }
                else if (slide.notes) {
                    page.append('p').html(slide.notes)
                }
                //<div class="ft-section" data-id="section-1">
                //}
            });
            //console.log('d3 done')
                // });      
                //      document.onreadystatechange = function () {
                // if (document.readyState == "complete") {
            //console.log('ready')
                // document is ready. Do your stuff here
                //sections = ftContainer.querySelectorAll(".flowtime > " + SECTION_SELECTOR);
                //Flowtime.NavigationMatrix.update()
            Flowtime.updateNavigation()
                // Configuration API test
            Flowtime.showProgress(true);
            // Flowtime.fragmentsOnSide(true);
            // Flowtime.fragmentsOnBack(true);
            // Flowtime.useHistory(false);
            Flowtime.slideInPx(true);
            // Flowtime.sectionsSlideToTop(true);
            // Flowtime.backFromPageToTop(true);
            // Flowtime.gridNavigation(false);
            // Flowtime.useOverviewVariant(true);
            Flowtime.parallaxInPx(true);
            //
            // event management
            // Flowtime.addEventListener("flowtimenavigation", onNavigation, false);
            Flowtime.onNavigation(onNavigation);

            function onNavigation(e) {
                //_gaq.push(['_trackEvent', 'Flowtime', 'Navigation', cacheTitle + ' > ' + document.title.replace("Flowtime.js | ", "")]);
                // console.log(cacheTitle + ' > ' + document.title.replace("Flowtime.js | ", ""));
                cacheTitle = document.title.replace("Flowtime.js | ", "");
                //console.log('section', e.section, 'sectionIndex', e.sectionIndex);
                //console.log('page', e.page, 'pageIndex', e.pageIndex);
                //console.log('pastSectionIndex', e.pastSectionIndex, 'pastPageIndex', e.pastPageIndex);
                //console.log('prevSection', e.prevSection);
                //console.log('nextSection', e.nextSection);
                //console.log('prevPage', e.prevPage);
                //console.log('nextPage', e.nextPage);
                //console.log('fragment', e.fragment, + 'fragmentIndex', e.fragmentIndex);
                //console.log("isOverview", e.isOverview);
                //console.log('progress:', e.progress, 'total:', e.total);
                //var value = Math.round(e.progress * 100 / e.total);
                //console.log('Completion: ' + value + '%');
            }
            // starts the application with configuration options
            Flowtime.start();
            //   }
            // }    
        });
    </script>
</body>

</html>